%% This is an example to plot current spikes from Brian2 operations in MATLAB
%% uncorrated Inputs (Membrane Voltage)
a=[ 0.00000000e+00  0.00000000e+00  8.79527682e+01  1.94521271e+02
  3.24260222e+02  4.78918467e+02  5.68234270e+02  6.59218737e+02
  6.98239290e+02  6.52304626e+02  5.55250686e+02  5.22717809e+02
  5.52599244e+02  5.72749071e+02  6.27350193e+02  5.57243636e+02
  4.78892462e+02  3.70122819e+02  2.70566158e+02  2.73034547e+02
  1.45335604e+02  5.37088056e+01  3.78720389e+01  2.61217174e+01
  4.15316294e+01  4.60188671e+01  6.53713025e+01  2.66768242e+01
  2.33841846e+01  2.21678464e+01  2.84700853e+01  6.46786813e+01
  1.14266232e+02  1.24020920e+02  8.62714952e+01  6.15603148e+01
  1.96342080e+01 -5.92924897e+00 -8.87781089e+01 -1.33672973e+02
 -1.31910109e+02 -1.09076422e+02 -1.43338654e+02 -2.08607944e+02
 -2.18421537e+02 -2.78927139e+02 -2.28177804e+02 -2.52753284e+02
 -2.93121969e+02 -3.11832570e+02 -2.43922272e+02 -1.27225332e+02
 -3.42327530e+01  4.20149704e+01  1.51682755e+02  1.63405539e+02
  1.67224263e+02  2.15116410e+02  2.86836175e+02  2.94388981e+02
  2.80837773e+02  2.77975734e+02  2.11029873e+02  2.00638251e+02
  2.48491911e+02  2.56948943e+02  3.09522207e+02  3.19480212e+02
  4.84524990e+02  6.41666093e+02  6.74871373e+02  6.34093593e+02
  4.82300300e+02  4.75027196e+02  3.68640930e+02  2.96504773e+02
  2.23574650e+02  2.02465674e+02  2.62959024e+02  3.24641100e+02
  3.85655661e+02  4.22502229e+02  4.42724801e+02  4.08831132e+02
  4.15141503e+02  4.00541079e+02  3.31100352e+02  2.77795907e+02
  1.15922130e+02 -4.23495580e+01 -1.69160053e+02 -3.44570274e+02
 -3.84423136e+02 -3.84607801e+02 -3.58206338e+02 -3.36856845e+02
 -2.96342655e+02 -1.80998569e+02 -5.09443812e+01  8.37407225e+01
  2.16376432e+02  2.93519443e+02  3.27230593e+02  3.32451368e+02
  2.72385088e+02  1.99157494e+02  1.49181352e+02  4.43056056e+01
 -4.26463807e+01 -6.27439697e+01 -1.09520041e+02  3.46126970e+01
  1.28697175e+02  1.91626159e+02  3.00836881e+02  3.65346911e+02
  2.80878460e+02  1.90874440e+02  1.44431177e+02  6.24535843e+01
  6.14114984e+01  1.80807030e+02  2.78241038e+02  3.33061612e+02
  2.85286592e+02  3.16974314e+02  3.53355958e+02  3.25633628e+02
  3.09925917e+02  2.56980194e+02  2.02937811e+02  2.16623441e+02
  2.48852239e+02  3.17691176e+02  2.93357062e+02  1.91282195e+02
  4.48976721e+01 -7.61447886e+01 -1.97948784e+02 -2.88141304e+02
 -3.04899002e+02 -2.73773862e+02 -2.84890695e+02 -1.85358619e+02
 -9.55147193e+01  7.31651776e+01  2.80093993e+02  3.36695009e+02
  3.93023199e+02  3.80645234e+02  4.41593322e+02  5.18396441e+02
  5.31950504e+02  5.30430266e+02  5.44797585e+02  5.01883255e+02
  4.70379525e+02  4.23882446e+02  3.93779535e+02  2.99518640e+02
  2.38612471e+02  2.48623973e+02  2.56442336e+02  2.20069320e+02
  3.63085096e+02  4.66075103e+02  5.17545459e+02  5.81425668e+02
  5.83398799e+02  5.72066473e+02  5.30485472e+02  4.98636894e+02
  4.03661894e+02  4.12387103e+02  3.94898044e+02  4.32913097e+02
  3.57717243e+02  2.54026290e+02  1.58106543e+02  1.83982632e+02
  1.82779257e+02  2.10367983e+02  1.87818136e+02  1.16685629e+02
  1.40978611e+02  8.27193431e+01  2.01750590e+02  1.94723451e+02
  1.64345001e+02  1.70484474e+02  2.02818820e+02  2.48815960e+02
  1.80138292e+02  1.34882677e+02  8.18984697e+01  3.46547419e+00
 -6.13735884e+01 -2.55944853e+01  2.21564730e+01  8.01319916e+00
  2.51448690e+01  4.03452815e+01  5.70900849e+01  4.37034352e+00
  9.31523061e+01  1.49029386e+02  8.88705973e+01 -2.14606693e+01
 -1.12573578e+02 -2.17519003e+02 -2.82175589e+02 -2.89476357e+02
 -3.03506396e+02 -3.66224649e+02 -3.61698292e+02 -3.79688547e+02
 -3.38270813e+02 -2.86688087e+02 -2.51670862e+02 -2.02582344e+02
 -2.17975623e+02 -2.54026969e+02 -1.23702346e+02 -1.37650556e+01
  1.06829721e+02  6.74054969e+01  4.84125191e+01  1.13372755e+02
  3.62353450e+01 -8.01433711e+01 -1.47886516e+02 -1.62139256e+02
 -2.52873643e+02 -2.68223706e+02 -3.03137110e+02 -3.23408822e+02
 -3.80840881e+02 -4.30507983e+02 -3.56707293e+02 -2.12975388e+02
 -1.69415802e+02 -1.83772907e+02 -1.60702467e+02 -1.15493781e+02
 -8.06340808e+01  1.54905312e+01  5.56580295e+00  6.92077312e+01
  1.10023812e+01 -7.16268106e+00 -1.21427801e+00  8.83242160e+01
  1.58124731e+02  1.49237485e+02  1.64691644e+02  1.94430354e+02
  2.25138666e+02  2.48445492e+02  2.46050444e+02  2.48816152e+02
  2.74222031e+02  2.91132437e+02  3.06991867e+02  3.68520958e+02
  4.07092673e+02  4.54466215e+02  4.60919044e+02  3.99576622e+02
  3.03987179e+02  1.40614629e+02  1.66840795e+02  1.45688842e+02
  1.88457844e+02  2.22740506e+02  2.07334835e+02  2.10976961e+02
  2.49821951e+02  3.08206453e+02  3.76177703e+02  3.77027486e+02
  3.40337619e+02  2.83118136e+02  2.13510095e+02  2.32406659e+02
  3.27861672e+02  3.00943659e+02  2.68763185e+02  2.14754232e+02
  2.42908153e+02  2.73422289e+02  3.02512995e+02  3.71005346e+02
  4.32593830e+02  4.86427468e+02  4.89655088e+02  4.63290589e+02
  3.93351851e+02  3.44695630e+02  2.84092811e+02  2.13126083e+02
  1.36528648e+02  1.29984044e+02  1.70640957e+02  1.47231028e+02
  1.29197764e+02  1.38729735e+02  5.45192206e+01  8.19114394e+01
  6.23978810e+01  1.29906423e+02  2.44029511e+02  3.33740726e+02
  3.09674474e+02  2.39242190e+02  5.20940945e+01 -5.81851321e+01
 -1.13945824e+02 -2.01772911e+02 -3.27111424e+02 -3.10681680e+02
 -2.32395438e+02 -2.09501193e+02 -1.26672550e+02 -5.60769744e+01
  1.18719464e+02  2.33535456e+02  3.06990851e+02  3.09327443e+02
  4.30503770e+02  4.29945940e+02  4.26144537e+02  4.02628719e+02
  3.73124217e+02  4.80875965e+02  5.43133629e+02  5.44350502e+02
  4.67306002e+02  2.97267860e+02  2.05985661e+02  7.14909379e+01
 -3.38512057e+01 -7.17777747e+01 -1.89658626e+02 -1.91915297e+02
 -1.22332175e+02 -1.20836880e+02 -9.14465250e+01 -9.63091786e+01
 -4.87115849e+01 -1.56775135e+02 -1.98979718e+02 -2.21126794e+02
 -1.80376711e+02 -1.51132850e+02 -1.28493232e+02 -8.16624974e+01
 -1.97223750e+01 -1.93935510e+01  6.87947619e+00  1.55302328e+02
  2.57448341e+02  3.05986600e+02  3.69527587e+02  3.98822448e+02
  3.64509709e+02  3.85685413e+02  3.20280164e+02  2.21770575e+02
  1.75761648e+02  1.44101650e+02  1.23570479e+02  1.56719237e+02
  8.22069697e+01  3.84170907e+01 -3.14806349e+01 -9.13131079e+01
 -4.80546141e+01 -3.43285992e+01  9.54001519e+01  1.90564707e+02
  2.36618635e+02  2.98307144e+02  2.74286067e+02  2.70906865e+02
  2.36031078e+02  2.05984875e+02  1.56759526e+02  1.22809384e+02
  1.08264519e+01 -7.60811432e+01 -1.47163332e+02 -2.75995442e+02
 -3.63831742e+02 -3.73600859e+02 -3.31192028e+02 -2.34791672e+02
 -1.34415992e+02 -7.94610482e+01 -7.94039159e+00  1.94637753e+01
  4.29309818e+01  1.36133025e+02  2.67172523e+02  3.90134413e+02
  3.86430746e+02  3.77423095e+02  3.25788062e+02  1.84701721e+02
  1.07426587e+02  9.36765775e+01  4.98561265e+00 -7.93492148e+01
 -1.35871601e+02 -1.79874221e+02 -1.70792749e+02 -1.95338234e+02
 -1.94118468e+02 -1.09602175e+02 -8.86105199e+01 -9.79516732e+00
  1.68254544e+02  2.60319837e+02  2.29820887e+02  2.40079317e+02
  2.73104564e+02  3.37537873e+02  3.23745543e+02  2.88481331e+02
  2.88199392e+02  3.10673621e+02  3.25079188e+02  3.31497406e+02
  3.05496222e+02  1.87809844e+02  8.96689627e+01  3.23698130e+01
  9.28926079e+01  1.53981138e+02  1.45031361e+02  7.19524336e+01
  3.41255744e+01  1.80978063e+00  6.75264036e+01  2.35345280e+01
 -1.61087744e+01 -7.03917750e+01 -6.21037789e+01 -4.27657941e+01
  4.62790972e+00  2.35142471e+01  4.99552242e+01  5.69564273e+01
  6.99350480e+01  6.31748443e+01  1.18379211e+02  1.41050985e+02
  1.90780672e+02  2.10291682e+02  2.33120485e+02  1.85934396e+02
  1.20557428e+02  9.33310046e+01  9.18258420e+01  6.24051721e+01
  4.28589011e+01 -1.54374635e+01 -5.09812864e+01 -1.16909246e+02
 -1.74462057e+02 -1.79154569e+02 -1.51050525e+02 -1.48565664e+02
 -4.65221277e+01  1.88283413e+01  1.05854199e+02  1.81799722e+02
  2.48284492e+02  3.74057872e+02  3.94942081e+02  4.45076612e+02
  3.94471130e+02  3.06997878e+02  2.46502243e+02  2.76239178e+02
  2.19667569e+02  2.50050835e+02  3.27880320e+02  3.07521649e+02
  2.68868787e+02  2.44408143e+02  2.57283023e+02  2.68541162e+02
  3.22900503e+02  3.33883167e+02  4.09129688e+02  5.62074400e+02
  5.63644201e+02  5.38106217e+02  5.69433311e+02  5.65192214e+02
  5.41044351e+02  5.79976296e+02  6.33274052e+02  6.21759467e+02
  5.93548426e+02  5.10154986e+02  4.20022359e+02  2.84261992e+02
  1.05391031e+02 -8.97317438e+01 -2.64628570e+02 -3.51588969e+02
 -4.03979168e+02 -4.29774120e+02 -4.10239776e+02 -3.39953371e+02
 -3.36614972e+02 -2.61422950e+02 -2.20615957e+02 -1.81212270e+02
 -1.38704196e+02 -2.35504815e+01  3.95602798e+01  4.64316757e+01
 -2.47947605e+01 -1.19308536e+02 -2.31518032e+02 -2.18626220e+02
 -2.23031405e+02 -2.80334703e+02 -4.15830622e+02 -5.04146548e+02
 -4.90419749e+02 -4.33927315e+02 -4.44212608e+02 -3.78454317e+02
 -3.38524353e+02 -2.49410622e+02 -2.28092915e+02 -2.75406480e+02
 -2.92914291e+02 -3.07867357e+02 -2.96266626e+02 -2.48790924e+02
 -2.74446651e+02 -2.06619921e+02 -2.02190984e+02 -1.65538460e+02
 -1.28483906e+02  5.04625828e-01  3.36475502e+01  4.81819950e+01
 -1.47142138e+01 -1.24076456e+02 -2.41897912e+02 -3.24259693e+02
 -2.27568406e+02 -2.06316864e+02 -1.80747316e+02 -1.25726853e+02
 -1.48383173e+02 -1.51604591e+02 -6.99106281e+01 -5.87902352e+00
 -4.33871760e+01  2.51857795e+00  5.55509333e+01  1.38373896e+02
  9.69724095e+01  9.45478804e+01  5.04838724e+01  1.31152346e+01
 -1.77677644e+01  1.84414831e+00 -1.30771877e+01  3.67665133e-01
  5.15035262e+01  7.59779019e+01  1.10188660e+01 -6.65289116e+01
 -1.55851941e+02 -2.27818943e+02 -2.36204516e+02 -2.23384038e+02
 -1.27648913e+02 -1.03762659e+02 -9.94670010e+01 -1.73266770e+02
 -2.47067914e+02 -2.05435492e+02 -9.82598800e+01 -9.11419873e+01
 -7.10154285e+01  3.42854445e+00 -4.91216277e+00  4.81010389e+00
  2.43016870e+01  6.01203757e+00  7.96924547e+01  1.57147813e+02
  2.79870788e+02  3.13722989e+02  3.43764277e+02  3.66823053e+02
  4.48566377e+02  5.64075584e+02  5.83867569e+02  5.48690884e+02
  6.42617148e+02  7.61798178e+02  8.44543345e+02  8.80076829e+02
  8.64411415e+02  8.90880488e+02  8.70693876e+02  9.12756703e+02
  9.46458149e+02  9.08667874e+02  8.29738182e+02  7.94441520e+02
  7.14611999e+02  6.79636157e+02  6.98803562e+02  7.49249838e+02
  7.23097463e+02  8.10722834e+02  8.67563313e+02  8.09764426e+02
  7.05857899e+02  7.38461024e+02  7.17265442e+02  6.45559726e+02
  6.17815829e+02  6.16248712e+02  6.94022899e+02  8.60087877e+02
  0.00000000e+00  2.23333143e+02  3.52699966e+02  3.71741908e+02
  3.17130918e+02  2.89843711e+02  3.06761106e+02  3.02456708e+02
  3.07537795e+02  3.17272464e+02  2.28658094e+02  1.03240161e+02
  7.96232716e+01  9.90187571e+01  1.47177211e+02  1.91246922e+02
  1.84900614e+02  1.69055674e+02  1.95620501e+02  1.32047527e+02
  1.27351280e+02  1.31659457e+02  1.18560073e+02  1.41456379e+02
  2.08880917e+02  3.03090907e+02  3.41914759e+02  2.98488139e+02
  2.72377638e+02  2.80039168e+02  2.39446773e+02  1.93289941e+02
  1.71641764e+02  1.20539991e+02  7.75643494e+01  6.91614581e+01
  1.53330555e+02  2.67720460e+02  4.42006593e+02  5.99386165e+02
  6.96182676e+02  8.00527727e+02  8.08741292e+02  8.44096186e+02
  8.21816893e+02  8.33939654e+02  8.24139989e+02  7.83325383e+02
  7.95572153e+02  7.90922604e+02  7.07559888e+02  5.57153946e+02
  4.85586616e+02  4.65061895e+02  5.01734241e+02  5.95604010e+02
  6.25728484e+02  7.23884624e+02  7.37274691e+02  7.90695382e+02
  7.49169763e+02  6.97385482e+02  6.22827572e+02  5.61797614e+02
  4.66793871e+02  3.77689058e+02  3.39645733e+02  3.56149272e+02
  2.65898025e+02  2.29861204e+02  2.52717623e+02  1.71351351e+02
  7.49253183e+01 -2.38004414e+01 -4.97467654e+01 -9.68085512e+01
 -6.23343412e+01 -7.51157342e+01 -8.88947131e+01  8.33269479e+01
  2.40665457e+02  2.40306609e+02  2.37028837e+02  2.10251754e+02
  2.64477133e+02  3.17831835e+02  3.22505816e+02  3.91903085e+02
  4.04471398e+02  4.21726656e+02  3.83806158e+02  3.14997614e+02
  1.89183492e+02  1.74177731e+02  1.35455100e+02  1.74191629e+02
  2.59222081e+02  2.75081144e+02  2.68723267e+02  3.44032499e+02
  4.00686954e+02  5.16662857e+02  5.50308261e+02  4.84708463e+02
  3.33418970e+02  2.00159044e+02  7.91823976e+01  1.93528238e+01
  2.32798874e+01 -6.75890334e+00 -3.47203732e+01 -8.48166675e+01
 -1.49307946e+02 -1.73071413e+02 -1.86498710e+02 -1.88200430e+02
 -2.01359159e+02 -1.91389970e+02 -1.62802495e+02 -1.69519609e+02
 -1.05953265e+02 -5.21974571e+01 -7.71861010e+01 -1.22650259e+02
 -1.79401088e+02 -1.93598865e+02 -2.29182114e+02 -2.61207738e+02
 -2.97815281e+02 -2.22324472e+02 -2.19238589e+02 -2.55818201e+02
 -3.11202888e+02 -2.82259284e+02 -2.04602242e+02 -1.71623463e+02
 -1.64937003e+02 -1.94586144e+02 -2.94586063e+02 -3.62965576e+02
 -4.07072123e+02 -4.80719890e+02 -5.65505186e+02 -5.80374345e+02
 -5.02789223e+02 -3.70580276e+02 -2.56552010e+02 -8.94229586e+01
  5.62445017e+01  1.80946912e+02  2.88485064e+02  3.57251299e+02
  4.21503810e+02  4.56795590e+02  4.00327014e+02  3.84026859e+02
  3.51600903e+02  2.68699214e+02  1.80886863e+02  1.39570966e+02
  6.19613261e+01  3.71896179e+01  1.38732746e+02  2.21067931e+02
  3.36350192e+02  3.74819384e+02  4.80126789e+02  5.51163552e+02
  5.73974853e+02  6.13363680e+02  6.60903215e+02  7.33480473e+02
  7.74317129e+02  7.97268385e+02  7.63626245e+02  7.64407818e+02
  7.62487695e+02  7.59455903e+02  7.55965248e+02  8.20402464e+02
  7.80443033e+02  7.20828719e+02  5.94996055e+02  5.20108085e+02
  3.42122702e+02  2.25342335e+02  6.14395210e+01 -1.22222632e+02
 -2.88060039e+02 -4.63068472e+02 -5.41705878e+02 -4.63398810e+02
 -3.37919318e+02 -2.11508933e+02 -8.89250708e+01  5.22121324e+01
  1.48704570e+02  2.78742665e+02  2.83660316e+02  3.01504585e+02
  3.21974515e+02  2.73374426e+02  3.96905852e+02  4.35675109e+02
  3.76375108e+02  3.29464139e+02  2.47932514e+02  1.26768642e+02
  5.53907571e+01 -3.43529901e+01 -8.85105237e+01 -6.71694343e+01
  4.78627713e+01  1.46181660e+02  2.52380739e+02  2.40176461e+02
  2.23615095e+02  1.14076811e+02  4.59196786e+01 -3.83171798e+01
  1.17993092e+01  1.15299433e+02  1.92350383e+02  2.68683002e+02
  2.99342869e+02  1.88530382e+02  1.58766581e+02  1.36455143e+02
  1.23173842e+02  7.41651175e+01  3.03567773e+01  8.27086549e+01
  1.42932571e+02  6.47654857e+01 -2.32991405e+01 -6.11769230e+01
 -4.01149772e+01  3.65589326e+01  4.58122847e+01  1.06013375e+02
  1.50110680e+02  1.82571010e+02  1.84041295e+02  1.47370147e+02
  9.08691224e+01  2.32915189e+01  5.92220388e-01  3.00619637e+01
  1.10188312e+02  7.70779733e+01  1.83305571e+01 -8.60148483e+01
 -1.94410949e+02 -2.71994339e+02 -2.75636238e+02 -2.34931058e+02
 -1.94997886e+02 -1.79072693e+02 -1.31651402e+02 -1.10520726e+02
 -5.50138236e+01  4.48626518e+01  1.24245421e+02  1.64378616e+02
  2.23766805e+02  3.60639887e+02  4.68430351e+02  5.52823694e+02
  5.50176388e+02  4.99292300e+02  3.97579509e+02  3.36627830e+02
  3.04525322e+02  3.38040944e+02  3.64004466e+02  3.88208214e+02
  4.36270864e+02  5.66430050e+02  6.04341543e+02  6.34783855e+02
  6.16551594e+02  6.61419922e+02  6.72130953e+02  5.90200373e+02
  4.90187223e+02  4.01510941e+02  2.79203840e+02  2.56548793e+02
  2.74766711e+02  3.17508151e+02  2.58381851e+02  2.33282348e+02
  2.28519037e+02  2.60004448e+02  3.10175136e+02  3.15285158e+02
  2.66391384e+02  3.04699920e+02  2.56341892e+02  1.33405329e+02
  8.74284853e+01  4.64625288e+01 -9.30063945e+00 -6.78579525e+01
 -1.00113953e+02 -1.10909645e+02 -6.18285883e+01 -2.18032368e+00
  3.91800306e+01 -3.55010504e+00 -7.79781488e+01 -1.16591251e+01
  6.72161554e+01  1.06029508e+02  1.91860047e+02  2.36509259e+02
  3.24073325e+02  4.55122314e+02  4.94695993e+02  5.72759065e+02
  6.26451821e+02  6.65722506e+02  7.14814015e+02  8.31921784e+02
  0.00000000e+00  1.88183057e+02  3.13769653e+02  3.97833259e+02
  4.99514408e+02  5.64185352e+02  5.80000883e+02  6.55196127e+02
  6.94026677e+02  7.10564599e+02  6.91808944e+02  6.76949211e+02
  6.90908409e+02  6.26429132e+02  5.58573281e+02  5.38969615e+02
  4.79768545e+02  4.19936526e+02  3.62361371e+02  3.10953738e+02
  2.22632692e+02  1.84643612e+02  1.99484196e+02  1.28065506e+02
  1.00321751e+02  2.68792251e+01  3.62055539e+01  7.32674792e+01
  5.96625710e+01  1.32902212e+02  1.84730788e+02  2.38934342e+02
  2.69053803e+02  3.76863126e+02  3.61065721e+02  3.37884111e+02
  2.42706716e+02  2.24901914e+02  2.36071709e+02  1.98702951e+02];
%% Corrated Inputs (Membrane Voltage)
b=[0.00000000e+00  0.00000000e+00  2.02487192e+01  9.14904410e+01
  1.63716758e+02  2.98731639e+02  4.15771435e+02  5.62229692e+02
  6.96029462e+02  7.64016453e+02  8.06570880e+02  8.56763939e+02
  9.08178560e+02  9.31933591e+02  9.10873430e+02  8.60332383e+02
  8.63819890e+02  0.00000000e+00  1.62544229e+02  3.42160066e+02
  4.93461803e+02  4.92338695e+02  5.31568456e+02  5.05852733e+02
  4.88102836e+02  5.19753092e+02  5.11891809e+02  4.60405955e+02
  4.57757484e+02  4.21483671e+02  3.93262198e+02  3.96128223e+02
  4.66578397e+02  4.38699280e+02  3.99929350e+02  4.46497930e+02
  4.73657960e+02  4.19888479e+02  4.76945934e+02  5.04067079e+02
  5.81986636e+02  5.26666628e+02  5.32057463e+02  5.47089793e+02
  4.93739820e+02  3.79299118e+02  2.81248505e+02  2.48537306e+02
  2.37599158e+02  2.19332850e+02  1.99438368e+02  2.73969282e+02
  2.89691915e+02  2.46748510e+02  2.60818034e+02  3.08274423e+02
  3.70930193e+02  3.94784178e+02  4.63816376e+02  5.31022441e+02
  4.99551332e+02  4.76977814e+02  4.37555194e+02  3.87678350e+02
  3.31608239e+02  3.87808711e+02  4.10752984e+02  4.08460121e+02
  3.94901856e+02  4.03609738e+02  4.49862771e+02  4.72188246e+02
  4.36538737e+02  3.93669060e+02  3.73373721e+02  4.13691809e+02
  3.98012970e+02  4.17352653e+02  4.57018429e+02  5.32449775e+02
  6.95340828e+02  8.57560060e+02  9.18291345e+02  8.87671775e+02
  7.74946376e+02  5.65650212e+02  3.93115806e+02  2.90292125e+02
  2.35008125e+02  1.67139630e+02  7.21930374e+01  8.13475103e+01
  1.28992880e+02  8.24715147e+01  7.33142859e+01  6.52229374e+01
  8.44813447e+01  1.46974259e+02  2.56594656e+02  2.27316243e+02
  1.80413275e+02  1.46672881e+02  1.51075760e+02  1.60219931e+02
  1.76609618e+02  2.23369656e+02  2.89167258e+02  2.73478362e+02
  3.48001075e+02  3.81376354e+02  4.32764965e+02  4.20334130e+02
  3.86098950e+02  4.25984478e+02  4.63877405e+02  4.78585520e+02
  4.26838107e+02  3.54861410e+02  2.26614705e+02  1.12111650e+02
  3.61986551e+01 -1.10895489e+01 -1.99169162e+01 -4.94867845e+01
 -3.98496341e+01 -3.39065099e+01 -9.02915711e+00 -1.53101046e+01
 -3.55029889e+01  3.12724985e+01  1.45216031e+02  2.60448928e+02
  3.25573619e+02  3.31029804e+02  2.54793071e+02  2.74226907e+02
  2.38167114e+02  9.77891691e+01  5.83802564e+01 -3.17635799e+01
  1.26488062e+01  2.31279497e+01  1.42211777e+01 -5.21091404e+01
 -1.24769005e+02 -1.23690679e+02 -7.49905454e+01  3.14495919e+00
  6.86671266e+01  1.42548207e+02  3.12190135e+02  4.16913254e+02
  4.97891766e+02  4.35604079e+02  4.22124717e+02  4.61785181e+02
  5.05991692e+02  4.86380444e+02  5.49763053e+02  5.95191098e+02
  6.52849980e+02  6.68962465e+02  6.84823768e+02  7.71780365e+02
  7.09243052e+02  6.23453740e+02  5.54256416e+02  4.98871103e+02
  4.69954137e+02  4.30928581e+02  2.99187675e+02  1.90011939e+02
  1.43670486e+02  6.46550217e+01  3.77111553e+01  1.05350429e+00
  1.20424095e+01 -3.71167892e+01  1.97287169e+01  1.39536925e+02
  2.68660336e+02  3.25414795e+02  2.86935113e+02  3.28577461e+02
  3.49154422e+02  3.84041100e+02  4.70308120e+02  4.63404613e+02
  4.90949156e+02  4.46996243e+02  3.84841398e+02  2.91015248e+02
  1.77917795e+02  1.41431474e+02  8.30391229e+01  1.51323775e+01
 -9.77111838e+00 -5.13651273e+01 -9.82517023e+01 -1.46067802e+02
 -1.45056809e+02 -1.34174179e+02 -1.44057512e+02 -1.68922039e+02
 -2.44196571e+02 -3.20038942e+02 -3.42972691e+02 -4.27452865e+02
 -4.33897749e+02 -3.65607824e+02 -3.96417448e+02 -3.98668452e+02
 -4.24984270e+02 -4.14291459e+02 -4.98945917e+02 -5.44925086e+02
 -5.59407301e+02 -5.26348510e+02 -3.94579580e+02 -2.35419479e+02
 -1.14669661e+02 -9.01221735e+01 -5.50318637e+01  1.24472581e+02
  2.44133902e+02  3.69437888e+02  3.30319533e+02  2.60483636e+02
  2.21914991e+02  2.01206742e+02  1.89575300e+02  2.76815346e+02
  3.51358620e+02  4.16688666e+02  4.52836067e+02  5.39629588e+02
  5.39952589e+02  5.12081684e+02  5.38696165e+02  5.51812711e+02
  5.10216982e+02  5.08370272e+02  5.10787026e+02  5.39211401e+02
  5.59239049e+02  5.74263321e+02  5.36408011e+02  4.16467066e+02
  3.40328628e+02  3.38789314e+02  3.35250585e+02  3.03582953e+02
  2.77571902e+02  2.14414430e+02  1.08822820e+02  7.50988640e+01
  4.26905210e+01 -3.43652579e+01 -6.50907038e+01 -8.92586451e+01
 -1.10554075e+02 -3.59103441e+01 -2.22841333e+01 -6.46552840e+00
  7.76431736e+00 -8.99121085e-01 -7.13517066e+01 -1.04821336e+02
 -1.33844730e+02 -1.82699908e+02 -1.04218148e+02  4.08658647e+00
  8.14584752e+01  1.84235699e+02  3.23311521e+02  4.55080247e+02
  5.31763847e+02  5.69487027e+02  6.24253228e+02  5.77622992e+02
  5.92042216e+02  6.22078213e+02  6.62864652e+02  6.63249343e+02
  6.11237166e+02  6.63081622e+02  7.53421982e+02  7.74374126e+02
  8.25116897e+02  8.93215075e+02  9.22826282e+02  8.58683584e+02
  7.87102794e+02  8.28456662e+02  8.45445325e+02  8.25306957e+02
  8.27776932e+02  7.98343126e+02  7.50390657e+02  7.35071017e+02
  7.85407923e+02  7.83975359e+02  8.46057757e+02  7.83887453e+02
  7.66417217e+02  7.30978828e+02  7.54893805e+02  8.59501608e+02
  9.14732337e+02  8.93123249e+02  0.00000000e+00  2.37881560e+02
  3.83514432e+02  5.15245651e+02  5.83963385e+02  6.54742348e+02
  6.55360354e+02  6.58220465e+02  6.12638935e+02  5.37321347e+02
  4.00277192e+02  4.14427168e+02  4.51372507e+02  4.53351910e+02
  4.96683184e+02  4.92939563e+02  4.64356857e+02  5.10264575e+02
  4.31069797e+02  3.46913137e+02  4.02994231e+02  5.17380167e+02
  5.69029992e+02  4.64405624e+02  4.08512134e+02  3.42107660e+02
  2.71495742e+02  1.77876019e+02  1.44688324e+02  1.48958121e+02
  1.32483070e+02  6.05292969e+01 -6.42510263e+01 -1.19497228e+02
 -1.03838855e+02 -1.40622706e+02 -1.65683311e+02 -1.12114303e+02
 -3.82040320e+01  6.58073793e+01  2.54196911e+02  3.90588113e+02
  4.66312367e+02  4.82655480e+02  4.13647541e+02  3.39182393e+02
  2.86449172e+02  3.39801172e+02  4.29757434e+02  4.45890606e+02
  3.99119590e+02  3.16579033e+02  2.40679945e+02  2.23245695e+02
  2.42998983e+02  3.52766253e+02  4.45089985e+02  4.33672796e+02
  3.61963162e+02  3.03575151e+02  3.67998713e+02  4.56075450e+02
  5.34316333e+02  5.56396129e+02  5.65911737e+02  5.69163394e+02
  5.22277574e+02  4.45646962e+02  4.67823339e+02  5.04862053e+02
  5.27373419e+02  5.56971451e+02  5.40354880e+02  5.25129747e+02
  4.45696886e+02  4.25226343e+02  4.41414267e+02  4.08956476e+02
  3.74004023e+02  2.18889350e+02  1.27560882e+02  5.83859699e+01
 -1.61724157e+01 -1.16938688e+02 -2.38241662e+01  4.38447992e+01
 -3.73410075e+00 -1.46836429e+02 -2.74825058e+02 -3.94482256e+02
 -4.59733267e+02 -5.61347095e+02 -7.07355762e+02 -6.18811226e+02
 -5.03927733e+02 -4.42274633e+02 -4.34809147e+02 -3.41661453e+02
 -3.14946202e+02 -2.81576801e+02 -2.64695068e+02 -2.34600026e+02
 -1.52438185e+02 -1.38745908e+02 -1.71543425e+02 -2.05217802e+02
 -3.05540496e+02 -3.29418194e+02 -3.98371933e+02 -5.37447913e+02
 -6.21593814e+02 -6.21977941e+02 -5.21637830e+02 -3.62169996e+02
 -2.43757008e+02 -1.12118883e+02 -6.69713860e+01 -2.80411529e+01
  2.34695074e+01  1.24952809e+01 -1.04930772e+02 -1.46065969e+02
 -1.16378121e+02 -2.83121830e+01 -2.96132833e+01 -8.75300122e+01
 -1.06974085e+02 -1.20586096e+02 -1.72587362e+02 -2.96413523e+02
 -4.14690094e+02 -5.42520712e+02 -6.25342559e+02 -6.34582763e+02
 -5.54757788e+02 -3.79930888e+02 -3.62099022e+02 -3.00475883e+02
 -2.34118666e+02 -1.66367653e+02 -1.94302571e+02 -1.86171234e+02
 -1.52695800e+02 -1.97073971e+02 -2.37104545e+02 -3.10826894e+02
 -2.35927707e+02 -1.86756983e+02 -1.75046073e+02 -1.38349506e+02
  5.47459395e+00  2.52330861e+02  4.13302400e+02  4.89692668e+02
  5.29230558e+02  5.47027989e+02  6.23109767e+02  7.09779519e+02
  8.01145720e+02  7.98374688e+02  8.97396900e+02  8.45402514e+02
  7.45700080e+02  7.31032260e+02  7.43637809e+02  7.93814119e+02
  7.45453206e+02  6.85599463e+02  6.25676091e+02  5.94241731e+02
  4.93429278e+02  4.50560614e+02  5.38252696e+02  5.40281237e+02
  5.59498434e+02  6.11558573e+02  6.13586209e+02  5.87792220e+02
  5.05891743e+02  3.94826113e+02  3.84100655e+02  3.40566073e+02
  2.51831914e+02  2.28937299e+02  2.02141880e+02  1.99209217e+02
  1.84615248e+02  1.56460374e+02  1.84828889e+02  2.02183873e+02
  1.67863157e+02  1.01132354e+02  1.99435273e+01 -3.91673917e+01
 -3.90138552e+01 -6.64944427e+00 -2.66647309e+01 -1.47401581e+02
 -2.05707589e+02 -1.50968760e+02 -9.84903478e+01 -7.47438019e+01
 -1.16061967e+02 -3.16753519e+01  1.07817648e+01  1.98842517e+00
 -3.81157949e+01 -5.06861251e+01 -1.18526459e+02 -1.03162084e+02
 -6.19484872e+01 -6.95704990e+00  1.69081727e+02  2.75471202e+02
  3.63453804e+02  4.60807401e+02  4.15383742e+02  3.95331259e+02
  3.94243835e+02  3.82485719e+02  3.88021223e+02  4.06316841e+02
  4.28855295e+02  4.07599661e+02  4.12674831e+02  4.32828263e+02
  3.85548501e+02  3.67362927e+02  3.27539524e+02  2.82590551e+02
  2.16964156e+02  3.02796289e+02  4.28070723e+02  4.57856497e+02
  4.07678983e+02  4.46013891e+02  4.65032894e+02  4.93902811e+02
  4.83583988e+02  4.01137834e+02  3.18822137e+02  3.09397604e+02
  2.30273367e+02  1.58614217e+02  1.60961733e+02  1.63895297e+02
  5.27248622e+01  1.50500840e+01 -6.49038563e+01 -4.04188716e+00
  2.19714900e+00 -8.41994332e-01  8.11809706e+01  1.40061674e+02
  1.62099184e+02  2.34035447e+02  2.19914427e+02  1.78657108e+02
  1.93253981e+02  1.95823749e+02  2.37672236e+02  3.71251354e+02
  5.98827936e+02  7.10854247e+02  7.72979775e+02  8.46322897e+02
  7.80019111e+02  6.73577138e+02  5.69183936e+02  5.19393634e+02
  4.83297683e+02  4.59195324e+02  3.45485796e+02  2.48622760e+02
  1.67664809e+02  1.20793060e+02  9.45348560e+01  3.24257590e+01
 -8.75648843e-01 -8.19864704e+01 -5.24343396e+01 -7.46493413e+01
 -1.26829385e+02 -1.67154564e+02 -1.24802264e+02 -5.42967086e+01
 -1.17111701e+01 -3.29240392e+01 -4.77202736e+01 -1.07626165e+01
  5.85093200e+01  9.92406350e+01  1.42826097e+02  1.84750525e+02
  2.70014064e+02  3.99755665e+02  5.04057934e+02  4.94434655e+02
  4.58653710e+02  3.86872088e+02  3.43111254e+02  3.17657619e+02
  2.54185605e+02  2.59870609e+02  3.10498888e+02  3.89108688e+02
  4.11611911e+02  4.42551790e+02  3.86221094e+02  3.27616491e+02
  2.66165024e+02  2.21831010e+02  2.58196970e+02  2.04943342e+02
  2.38817435e+02  1.61884919e+02  1.56339076e+02  1.50749211e+02
  1.96405303e+02  2.51822938e+02  2.17427480e+02  1.73152813e+02
  1.71317940e+02  2.19447768e+02  2.46837597e+02  2.35734426e+02
  2.28847554e+02  2.47674807e+02  2.82911715e+02  3.28318090e+02
  4.24314244e+02  6.14054945e+02  7.13726036e+02  7.12648436e+02
  6.75143354e+02  5.95294593e+02  7.00008247e+02  8.19130522e+02
  0.00000000e+00  2.27520055e+02  3.63191109e+02  4.16190077e+02
  5.29105674e+02  5.95989493e+02  5.98847529e+02  4.86792846e+02
  3.10092667e+02  1.76919288e+02  2.14892640e+02  3.52202046e+02
  4.71975269e+02  5.25107054e+02  5.37153674e+02  5.30284885e+02
  5.15504903e+02  4.74197295e+02  3.94803405e+02  2.88348017e+02
  2.12759890e+02  9.54419072e+01  3.15228245e+01 -6.47776630e+01
 -3.87727029e+01  1.43678832e+01  8.04788479e+01  6.04141502e+01
  3.70861312e+01  8.33432297e+01  8.17973436e+01  7.97192674e+01
  8.14250915e+01  1.33933703e+02  1.46108652e+02  1.80037531e+02
  2.50306105e+02  3.35842764e+02  3.98387556e+02  4.45035893e+02
  4.83273637e+02  4.22711638e+02  3.01882563e+02  3.09504018e+02
  3.24736919e+02  3.42394807e+02  4.74561972e+02  5.09007323e+02
  5.74144005e+02  6.77092660e+02  7.09559145e+02  7.45678062e+02
  7.53022795e+02  7.14518495e+02  6.73753969e+02  6.80910525e+02
  9.00048242e+02  0.00000000e+00  3.21155302e+02  5.91588013e+02
  6.98578166e+02  6.96682963e+02  6.99106145e+02  6.81293678e+02
  6.49889086e+02  5.87476572e+02  5.05915396e+02  4.85848640e+02
  4.82994413e+02  5.13081681e+02  4.90787878e+02  4.77884352e+02
  4.19603347e+02  3.57743599e+02  2.76416429e+02  2.58169811e+02
  3.46355842e+02  3.80059282e+02  5.16892370e+02  5.53877468e+02
  5.81911061e+02  5.85707411e+02  5.09884630e+02  5.51993461e+02
  5.71421629e+02  5.53230756e+02  5.13530168e+02  5.10305383e+02
  4.62323096e+02  4.55493956e+02  4.01776578e+02  3.43819784e+02
  3.98976405e+02  4.08316033e+02  3.42999805e+02  2.73226421e+02
  2.25064320e+02  1.95476060e+02  2.26188973e+02  3.17699067e+02
  2.99289814e+02  2.58351082e+02  2.77652203e+02  2.85899847e+02
  2.85357290e+02  2.77719446e+02  1.99468869e+02  1.73407293e+02
  2.24540985e+02  3.23040805e+02  3.10882331e+02  3.03210395e+02
  3.43631781e+02  3.41847571e+02  3.63217783e+02  2.56825875e+02
  2.55510786e+02  2.20929299e+02  1.90021440e+02  3.24862667e+02
  3.90969241e+02  3.67288236e+02  3.14165993e+02  3.40758877e+02
  3.92769244e+02  3.19449401e+02  2.43698465e+02  1.94187160e+02
  9.56808015e+01  1.55934485e+01 -3.09669621e+01  1.58603618e+01
  7.19820645e+00  1.52765471e+01  3.51285551e+01  1.10704428e+02
  1.23831969e+02  1.22052357e+02  2.04229638e+02  3.07143602e+02
  4.85784984e+02  6.34753573e+02  6.67322134e+02  6.49902301e+02
  6.73924924e+02  6.77165422e+02  6.67241764e+02  6.94487831e+02
  6.98039701e+02  6.44245371e+02  6.47160747e+02  6.58991396e+02
  6.34407976e+02  7.51906691e+02  8.35511957e+02  8.50641700e+02
  8.68701574e+02  8.42964946e+02  8.19112885e+02  8.68203962e+02
  8.91563589e+02  9.21382294e+02  0.00000000e+00  1.65459253e+02
  2.42730457e+02  3.55511669e+02  4.38074252e+02  5.21510836e+02
  5.78842039e+02  5.93304714e+02  5.82668051e+02  5.61120796e+02
  5.57415047e+02  5.39400378e+02  4.44421803e+02  3.78453933e+02
  3.06397237e+02  2.68614204e+02  2.94495099e+02  2.18165226e+02
  1.74549979e+02  1.12350881e+02  9.27437031e+01  3.31010337e+01
 -4.31771187e+00 -3.22483288e+01 -1.00854425e+02 -1.41436372e+02
 -9.10148128e+01 -7.89871806e+01 -9.50423002e+01 -1.11495538e+02
 -1.26976010e+02 -1.35589047e+02 -1.57391929e+02 -2.08312354e+02
 -1.83684367e+02 -8.97424516e+01 -9.91876455e+01 -6.06540001e+01
  2.83098473e+01  7.84656016e+01  1.05409664e+02  1.64070050e+02
  2.41707701e+02  2.32388057e+02  2.59763170e+02  2.88476959e+02
  3.38157034e+02  4.16162318e+02  4.85296733e+02  6.39825386e+02
  7.01107458e+02  8.86672657e+02  0.00000000e+00  2.00853196e+02
  3.07682664e+02  3.33319114e+02  3.32599968e+02  2.40943842e+02
  2.34267236e+02  2.79732402e+02  2.60116982e+02  3.84370874e+02
  4.94926866e+02  5.46175906e+02  6.51026830e+02  7.31059674e+02
  7.24937793e+02  6.04900579e+02  5.86243465e+02  5.84546309e+02
  5.69902738e+02  5.48363848e+02  5.68940776e+02  5.01991916e+02
  4.58137121e+02  3.14318760e+02  2.53230356e+02  1.73198923e+02
  3.45126232e+01 -1.95720216e+01 -6.33585639e+01 -9.57822619e+01
 -7.40528066e+01 -2.45441143e+01  4.11134954e+01  1.15329516e+02
  1.00152021e+02  9.96301355e+01  1.30092483e+02  1.09580004e+02
  1.96054150e+02  2.54311980e+02  2.97685087e+02  3.56805408e+02
  4.70630678e+02  6.13128180e+02  6.74828699e+02  6.82321333e+02
  5.86379588e+02  6.62884660e+02  7.02954734e+02  7.43381432e+02
  7.57556764e+02  7.56612985e+02  7.70571612e+02  7.45558571e+02
  7.67919621e+02  8.19676542e+02  8.63651427e+02  9.46159964e+02
  0.00000000e+00  2.55306947e+02  5.19554665e+02  6.61792995e+02
  8.15965138e+02  9.03351778e+02  9.42749887e+02  0.00000000e+00
  2.02197239e+02  3.36431752e+02  3.52856983e+02  4.07448983e+02
  4.33005196e+02  3.97552090e+02  3.53765677e+02  4.22216914e+02
  5.10746913e+02  5.87247060e+02  7.46291143e+02  8.97557600e+02
  9.18972189e+02  8.83344366e+02  7.41019709e+02  7.20201867e+02
  5.61051715e+02  4.16701542e+02  3.40329672e+02  2.68009547e+02
  1.59791464e+02  5.71183091e+01  5.35066291e+01  3.77644884e+01
  3.59884979e+01  2.30436877e+01  7.46945379e+01  1.88289939e+02
  2.65856561e+02  3.85429881e+02  3.64165030e+02  2.60046554e+02
  2.66682684e+02  2.89382669e+02  2.75459860e+02  2.19064930e+02
  1.61938531e+02  1.52962574e+02  1.07721605e+02  2.04538332e+02
  2.70050497e+02  3.40886893e+02  2.99794443e+02  2.63050251e+02
  2.09651561e+02  1.28559145e+02  5.73175468e+01 -3.09682245e+00
 -7.43419994e+00 -3.09722510e+00 -2.23963848e+01  3.24330980e+01
  3.90145246e+01  1.07095708e+02  1.18465593e+02  1.16365278e+02
  1.93562051e+02  2.22176830e+02  2.16172936e+02  2.33422566e+02
  2.66015235e+02  3.06238595e+02  3.26042521e+02  3.83243301e+02
  3.68656852e+02  3.06015990e+02  2.57209932e+02  2.40181394e+02
  1.98577450e+02  1.93678751e+02  2.15945357e+02  2.12710921e+02];
a=reshape(a',1000,1);
b=reshape(b',1000,1);
t=(0:0.1:99.9);
% plot membrane voltage
figure(1);
subplot(2,1,1);plot(t,a);
xlabel("time /us")
ylabel("Membrane Potential /mV")
title("uncorrelated inputs")
subplot(2,1,2);plot(t,b);
xlabel("time /us")
ylabel("Membrane Potential /mV")
title("correlated inputs")
% spike count and timing
xxa=[63.4,95.8];xa=1;
count_a=2;
xxb=[2.7  3.5  4.   9.3  9.7 10.3 12.1 23.3 30.9 31.6 33.3 33.5 36.1 43.1 54.3 63.  65.2 66.7 67.1 68.9 94. ];xb=1;
count_b=21;
aa=zeros(1000,1);
bb=zeros(1000,1);
for i=1:1000
    if i==xxa(xa)*10
        aa(i)=0.8;
        xa=xa+1;
    else
        aa(i)=a(i)/5000;
    end
    if i==xxb(xb)*10
        bb(i)=0.8;
        xb=xb+1;
    else
        bb(i)=b(i)/5000;
    end
    if xa>count_a
        xa=1;
    end
    if xb>count_b
        xb=1;
    end
end
figure(2)
subplot(2,1,1);plot(t,aa);
xlabel("time /us")
ylabel("Current /mA")
title("uncorrelated inputs: 2 spikes")
axis([0 100,-0.3,1])
subplot(2,1,2);plot(t,bb);
xlabel("time /us")
ylabel("Current /mA")
title("correlated inputs: 21 spikes")
axis([0 100,-0.3,1]) 
